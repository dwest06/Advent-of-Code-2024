from pprint import pprint
imap = """............
........0...
.....0......
.......0....
....0.......
......A.....
............
............
........A...
.........A..
............
............"""

imap2 = """..............U.............c.....3...............
.....p.........F..................................
.....m..7....................4x............3......
..e.............F..........c...YH..3..............
.......e...................................c..E..8
................a...U................8............
..............................4.F...8....x........
............7.....4............Hc..E.......x......
........p..............................E..........
.............U.e....................x....t........
.7..........................Z.H....g..............
.........7..m.....S.........................E.....
...F.....p...........6...SY.......................
.................6..k...................g.........
..........m......a........................g.......
.......M.......................................g..
..............a............Y....C........H........
....u.......6........a.........C.GY...............
.....M..................S......................2..
..........M........S.....................2........
........M.......................5.........z..f....
.....................................Z........t.2.
..........6.......................................
......................................G...........
.........................A.........G9....Z........
........................C.........................
.....k......................G......z..t...........
.......k......................zs....f........5...9
................h........................9....2...
.............h.....0...........f.....K..ZX........
..................................f...............
.......1....................9.........Xz..........
...............1......B.s......X..................
............h...............B.....................
..T.........k..................b..................
...............u..................................
.........u.............h..................0.......
..............y...................................
...............................t....X......5......
.................A............................5...
................u..................s..............
.T..........b....y................................
............y............................K........
..1...............................s....B..........
..............Ay.............B...P................
..........T.......................K...........0...
.............T..................P.........K.......
......A....P......................................
....b.........1...................................
.........b................................P......."""


def read_input(map):
    return [list(i) for i in map.split('\n')]

def printmap(imap):

    print("   ", end='')
    for i in range(len(imap)):
        print(f"J{i} ", end="")

    print('')
    for index, i in enumerate(imap):
        print(f"I{index}", end='')
        if index < 10:
            print(" ", end='')
        for k, j in enumerate(i):
            print(f" {j} ", end='')
        print('')


def main(data):
    # printmap(data)
    # Search all frequencies with their position
    anntenas = {}
    for i, line in enumerate(data):
        for j, value in enumerate(line):
            if value != ".":
                if value in anntenas:
                    anntenas[value].append([i, j])
                else:
                    anntenas[value] = [[i,j]]

    size = len(data)
    antinodes = 0
    for _, values in anntenas.items():
        for index, a in enumerate(values):
            for b in values[index + 1:]:
                idiff = a[0] - b[0]
                jdiff = a[1] - b[1]
                x = a[0]
                y = a[1]
                while (True):
                    x += idiff
                    y += jdiff

                    if not (0 <= x < size and 0 <= y < size):
                        break

                    if data[x][y] != '#':
                        data[x][y] = '#' 
                        antinodes += 1

                idiff = b[0] - a[0]
                jdiff = b[1] - a[1]
                x = b[0]
                y = b[1]
                while (True):
                    x += idiff
                    y += jdiff

                    if not (0 <= x < size and 0 <= y < size):
                        break

                    if data[x][y] != '#':
                        data[x][y] = '#' 
                        antinodes += 1

    for i, line in enumerate(data):
        for j, value in enumerate(line):
            if value != "." and value != "#":
                if len(anntenas[value]) < 1:
                    continue
                
                antinodes += 1
    # printmap(data)

    return antinodes

pprint(main(read_input(imap2)))