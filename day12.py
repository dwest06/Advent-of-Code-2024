imap = """RRRRIICCFF
RRRRIICCCF
VVRRRCCFFF
VVRCCCJFFF
VVVVCJJCFE
VVIVCCJJEE
VVIIICJJEE
MIIIIIJJEE
MIIISIJEEE
MMMISSJEEE"""

imap2 = """CCKKKKKKKLLLLLLLLLLLLLLLLLSQQQQQQQQQQQQQQQQQQQQQQQQRRQQQQQQQQQQGGGGGGIIIIIIIPPPPPPPPPNNNNNNNNNNIIIIIIIIRRRRRRRRRRRUUUUUUUUUUTTTTTTNTTTTTTTTT
KKKKKKKLLLLLLLLLLLLLLLLLLLLQQQQQQQQQQQQQQQQQQQQQQQRRRRRRQQQQQQQGGGGGGGIIIIIPPPPPPPPPPNNNNNNNNNNIIIIIIIIRRRRRRRRRRUUUUUUUUUUUTTTTTTTVTTTHHTTT
KKKKKKCQQQLLLLLLLLLLLLLLLTQQQQQJQQQQQQQQQQQQQQQQQQRRRRRRRQRQQQGGGGGGGGGIIIIIIPPPPPPPPPPPNNNNNNNNIIIIIRRRRRRRRRRRRRRUUUUUUTTTTTTTTTTTTTTHHWWT
QIIKKKKQQQLQLLLLLLLLLLLLLLQSSQJJQQQQQQQQQQQQQQQQRRRRRRRRRRRQGGGGGGGGQQZZIIIIIPPPPPPPPPPNNNNNNNNNIIIIIIRRRRRRRRRRRRRUUUUUUTKKTCTTTTVVTTWHHWWW
QQIKKKQQQQQQQLLLLLLLLLLLLLSSSJJJJQJQQJQQQQQQQQQQRRRRRRRRRRRRGGGGGGGGZZZZIIIPPPPPPPPPNNNNNNNNNNNNIIIIIIIRRRRRRRRRRRRUUUUUCCKCGCTTTTTTTWWHHWWW
QQQKKQQQQQQQQLLDDLLLLLLLLSSSJJJJJJJJJJQQQQQQQQQQQQRRRRRRRRRRGGGGGGGGGZZZIIIPPPPPPPPPPMNNNNNNNNNNIIIIIIIIRRRRRRRRRRRUUUURRCCCCCTTTTTWWWWWWWWW
QQQQQQQQQQQQLLLDDLLLLLSSLSSSJJJJJJJJJJQQQDDDDQQQQQQRRRRRRRRRGGGGGGGGGZZIIIPPPPPPPPPPPMMNNNNNNNNIIIIIIIIISSRRRRRRRRRRRRRRRCCCCCTTTTTWWWWWWWWW
QQQQQQQQQQQLLLLDOLLLXLSSSSSSJJJJJJJJJJJQQDDDMMMMMMMMMMRRRRRRGGGGGGGGGZZZJIPIPPPPPPPPHWMWNNNNNNIIIIIISSSIVVVRRRRRUFRQRRRRCCCCCCCTTTTWWWWWWWWW
QQQQQQQQQQQLLLLDDDDDDSSSSSSJJJJJJJJJJJQQQQQDMMMMMMMMMMRRRRRGGGGGGGGGGJJBJIIIIPPPPPPWHWWWWNNNNNIIISSSSSSYVVVRRRVRFFFFURRRZCCCCCCSTTTTWWDWDWWW
QQQQQQQQQQQQQDDDDDDDDSSSSSSSJJJJJJJJJJDQQDDDMMMMMMMMMMURRRRGGGGGGGGGGJJJJJIIIPPPPPWWWWWWZNNNIIIIIISSSVVVVVVVRVVFFFFFUSRRCCCCCCCSSWWWWWDDDDWW
PPQQQQQQQQKQDDDDDDDDDDDSSSSSJJJDJIMJJPDDDWDDMMMMMMMMMMURRRRGGGGGGGGGJJJJJJIIIPPPSPWWWWWWWZZZCCCIIIXSVVVVVVVVRVVVVFFSSSSRCCCCCCCSSWDDWWWDDDDW
PPQQTQQQQKKKDDDDDDDDDDDDDSSSJJMMMMMPPPPDDDDDMMMMMMMMMMRRRDRGGGGGGJJJJJJJJJIIIIPPWWWWWWWWWCZZCCCIIIXVVVVVVVVVVVVVVVFSSSRRCCCCCCSSSSDDDWWDDDWW
PPPQPQQNQKKKKKKDDDDDDDDDURSSSMMMMMMMMPPPPDDDMMMMMMMMMMUDEDODDGGGGJJJJJJJJJJJBIPWWWWWWWWWCCZCCCCIIXXXXWVVVVVVVVVVVVVVYCCCCCCCCCSSSSDDDDDDDDDD
PPPPPQQPPPKKKKKDDDDDDUUUURRRSMMMMMMMMMPPDDDDMMMMMMMMMMDDDDDDDGGGGGJJJJJJJJJBBBDDDWWWWWWCCCCCCCXXXXWWWWVVVVVVVVJJJVVVYCCCCCCLSSSSSSVDDDDDDDDD
PPPPPPPPPJKKKKDDDDDUUUUURRRSSMMMMMMMLLPDDDDDDDDDDDDDDDDDDDDDDGGGGGGGJDJPPDDDDDDDDWWWWWWWWCCCCCCWWWWWWWWWVVVVVVJJJJWWJCCCCCLLSSSSSSSSSDDDDDDD
PPPPPPPPPPKKKKDDHDUUUUURRRRRRRMMMMMMLLLLLDDDDDDDDDDDDTDDDGGGGGGGGGGGGDPPDDDDDDDDDDDWWWWWWCCCCCWWWWWNWWWWWVVVVVJJJJJJJJCCCCLLSSSSSSSSBDDDDDDD
PPPPPPPPKKKKKKKKKKUUUUURRRRRRMMMMMLLLLLLLKKDDDDDDSSDDDDDDGGGGGGGGGGDDDDPPDDDDDDDDDDWWWGGGGGGGGGGWWWWWWWWWWVVVVVJJJJJJJJCCCCCSSSSSSSSSSDDDDDK
PPPPFFPPPKKKKKKKKKUUKURRRRRRRMJMMMMLLLLLLKKDDDDDSSSSDBDDDHHHGGGGGGDDDDDDDDDDDDDDDDDDDWGGGGGGGGGGWWWWWWWWWVVVVVVJJJJJJJJJCCCCSSSSSSSSDDDDDDDD
PPFPFFPPPKKKKKKKKKKKKULRRRMMMMMMMMMLLLLLLLDDDDSSSSSSUBBBDDHHHGGHHGHDDDDDDDDDDDDDDDDDDDGGGGGGGGGGWWWWWWWWWWWVVVVJCJJJJJJJCHHSGSSSSSSSSDDDDDDD
EEFFFPPPKKKKKKKKKKKKKULLRRRMMMMMMMMLLLLLLLBBSSSSWSSSSSBBDHHHHHHHHHHHDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWWWIIIIVVVVVJJCJJJJJJHHHSSSSSSSSSSSDDDDDQQ
EEFFEPPKKKKKKKLLLKKKKULLRRRRMMMMMMMMLULLLLBBSSSSSSSSSSBCCCCCCCCCHHHDDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWWISIIIIIVVVVVVNNJJJJJJSSSSSSSSSSSSSDDDDDQ
EEEEEKKKKKKKKKLLLKLLLLLRRRRRRMMMLMMMLRRRLBBBBSSSSSSSSSSCCCCCCCCCHHHDDDDDDDDDDDDDDDDDGGGGGGGGGGGGWWWRIIIIIIIIVVVVVNJJJJJJSSSSSSSSSSSSSSDDDDDQ
EEEEEEKKKKKGKKLLLLLLLLLLLRRRRRRRLLLRRRRRLBBBSSSSSSSSSSSCCCCCCCCCCHHDDDDFDDDDDDDDDDDDGGGGGGGGGGGGWWRGGGGGGGIAVVVVJJJJJJJJSSSSSSSSSSSSSSDDDDDD
EEEEFGGGGGKGGGLLLLLLLLLLLRRRRRRRLLLRRRRRBBBBBSSSSSSSSSCCCCCCCCCCCHDDDDDFDLDDDDDDDDDDGGGGGGGGGGGGGGGGGGGGGGIIIVJJJJJJJJIIISIISSSSRSSSSSDDDDKK
ECCCCGCGGGGGGGLLLLLLLLLMRRRRRRRRLLLLLRRCBBBCSSSSSSSSSSCCCCCCCCCCCHDDDDDFDLDDDDDDDDDDGGGGGGGGGGGGGGGGGGGGGGIVVVVVJJJJJJIIIIIRESSSRRSRRSRRKDKK
ECCCCGGGGGGGGLLLLLLLLLLLRRRRRRRRRLLLCCCCBBCCCDSSSSSSSSCCCCCCCCCCCDDDDDDDDLDDDDDDDDCCGGGGGGGGGGGGGGGGGGGGGGIVVVVXXXJJXXXIIRRRRRRSRRRRRRRRKKKK
CCCCUGGGGGGGGLULLLLLLSSSRRRRRRRRLLLLLCCCCCCCCSSSSSSSSSCCCCCCCCCIIIDDIDDDDLLLLDDDDDCCGGGGGGGGCCCCCCRGGGGGGGFVVVXXXJJJXXXIIIRRRRRRRRRRRRRRRKKK
CCCCCCGMGGGGGLLLLLLLLSSSSSSRRRRRRLLLLLCCCCCCCSBSSSSSSSCCCCCCCCCQIIIDIDDRDDLLLDDDDDCCGGGGGGGGCCCCCRRGGGGGGGFFFVVXXXXXXXXXIRRRRRRRRRRRRRRRRRKK
CCCCCCCCGGGGLLLLLLLLLLLSWSSRRLRLLLLLPLLCCCCCCSSSSSSSSSCCCCCCCCCQQIIIIIDDDDLLLLLDDLCCCCCGGGGGPCCCCRRGGGGGGGFFFFVXXXXXXXEXXRRRRRRSRRRRRRRRRRRK
CCCCCCCCGGGGGGGLLLLLLSSSWWRRLLLLLLLLPCCCCCCCCSNSSSSSSSCCCCCCCCCQIIIIIIDKKLLLLLLLDLLLCCCGGGGGPPPPRRNGGGGGGGNFFXXXXXXXXXXXDRRRRSSSSSRSSRRRKKKK
CCCCCCCCCGGGGGLLLLLLSSSSWWRRLLLLLPPPPPCCCCCCCCNNNSSSMMCCCCCCCCCIIIIIIKKKKLLLLLLLLLLLCCCGGGGGPPPPRRNNNNNNNNNFFXXXXXXXXXIIGGGGGSSSSRRSSRRSSSKK
CCHCCCTCMMGGGSSSSLSSSSSSWWTRLLLLYYPPPPPCNCCCCNNNSSSSSMCCCCCCCCCIIIIIKKKKKLLLLLLLLLVVVPPPPPPPPPPNNNNNNNNNNNNFFXFXXXXXXXXIIGGGCSSSSSRSSSSSSKKK
CCCCCWTTGGSSSSSSSSSSSSWWWWLLLYYYYYPPPPMNNNCCCNNNSSSSMMCCCCCCCCCIIIIIKKKKKKKLLLLLLLVVVVPPPPPPPPPNNNNNNNNNNNNNFFFXGXEXXXIIIIGGCSSSSSSSSSSSKKKK
CIIIWWTTTGGGGGGGGSSSSSSSWSSLLYYYYYYPPPNNNNNNNNNNNSMMMMMMMMMMMIIIIIKKKKKKKKKKKILLLLVVVVPPPPPPPPPPNNNNNNNNNNNNFFFFFEEEXXIIIIGGGSSSSSSSSSKKKKKK
IIIWWTTTGGGGGGGGGGGSSSSSSSSSYYYYYYYYYYNNNNNNNNNNNSMMMMMMMMMIIIIIIIIKKKKKKKKKKKLLLLVVVVPPPPPPPPPNNNNNNNNNNNNNFFFFFEEEXXXXIGGGGSSSSSSSSSKKKKKK
IIIIITTTTGGGGGGGGGSSSSSSYYYYYYYYYYYYNNNNNNNNNNNNNNAMMMMMMMMIIIIIIIIKKKKKKKKKKKLBBLLVVPPPPPPPPPPNNNNNNNNNNNNNFFFFFFEEXXXXIGGGGSSSSSEEKKKKKKKK
IIITTTTTTGGGGGGGGGGGSSSSSYYYYYYYYYYYVNNNNNNNNNNNNNNUMMMIIMIIIIIIIIKKKKKKKKKKKKBBBBLLLLPPPPPPPPPPNNNNNNNNNBNBFJFFEFEEXXXXXGGGGGSSEEEEKKEKKKKK
IIITTTTTTGGGGGGGGGGGSRSSSSYYYYYYYYYYYYNXNNNNNNNNNNNNCMMIIIIYYIIIIIKKKKKKKKKGGKBBBBLLLLPPPPPLPPPPNNNNNNNNBBDDDJFFEEEXXXXXJJGGJGSSREEEEEEKCKKK
IIITTTTTTGGGGGGGGGGGGRRRYYYYYYYYYYYYYYXXNWWNNNNNNNNNCMMXXIYYYIYIIIIKKKKKKKKKKKBBBBLLLLLLPPPLPPPPWWNNNINNNDDDDDEEEEEXXXXXJJJJJJSHEEEEEEEECKKC
IXIIIIITPPPGGGGGGGGGGRRRRYYYYYYYYYYYYYYYWWWNNNNNNNNNNMXXXXXYYYYYYIIKKKKKKKKKRKBBBBBXXXLPPPPLPPPPWWANIIIIIDDDDDDDEEFXXXXXXXEEEESEEEEEEEECCKCC
XXXXXIIIPPGGGGGGGGGGGRRRRRYYYYYYYYYYYYYYYWNNNNNNNNXXXXXXXXYYYYYYYYYKKKKKKKKKKBBBBBBXXXLLLLLPPPPWWWAIIIIIIDDEEDEEEFFFXXXXXEEEEEEEEEEEECCCCCCC
XXXXIIIIIPGGGGGGGGRRRRRRRYYYYYYKYYYYKYXXXJWNNNNNNXXXXXXXXXYYYYYYYYYAAKKKKKKKKBBBBBBXXXXXXXLLVPWWWWAAAIIIDDDDEEEFEFFFXXXEEEEEEEEEEEEEEECCCCCC
XXXXXIIIPPGGGGGGGGRRRRRRRYYYYYYKYYKKKKXXXJJSNNNNXXXXXXXXXYYYYYYYYYAAKKKKKKKKBBBBBBBBBXXXXXLLVPAAWWAAAAIIDDDDJEEFFFFFXXXEEEEEEEEEEEEEECCCCCCC
XXXXSSSSWWWWPGGNNNRRRRRRRRYYYYKKKKKKKXXXXJJJJNNNXXXXXXXXXYYYYYYYYYYAAUUKKKKKBBBBBBBBBXXXXXXAAJAAAWAAIITTTTIIJEFFFFFXXXXEEEEEEEEEEEEECCCCCCCC
XXXXXWWWWWWWGGNNNNRRRRRRRRYYYKKKKKKKKKXXXXXJJJNNXXXXXXXXXYYYYYYYYYAAAAKKLKKBBBBBBBBBBXXXXXXAAAAAAAAAAATTTTIJJJXFFFFXFXXFEEEEEEEEEEECCCCCCCCC
XXXXTWWWWWWWWGWNNRRRWRRRRRMYYJJKKKKKKXXXXJJJJJJNXXXXXXXXYYYYYYYYYYAAAAAALLLLBBBBBBBBXXXXXXAAAAATTTTTTTTTTTIJJJFFFFFFFFFFFEEEEEEEEEEECCCCCCCC
HTTTTJWWWWWWWGWRRRRWWRRRRRYYYJJKKKKKKKXJJJJJJJJJJXXXXXXXYYYYYYYYYAAAAAALLLLLBWBBBBBBXZZZXXAAAAATTTTTTTTTTTJJJJJFFFFFFFFFFEEEEEEEEEEECCCCCCCC
TTTTWWWWWWWWWWWWWWWWRRRRRYYJJJWWKKKKKKKKJJJJJJJJJXXXXXXXUYYYYYYAAAAAAAALLLLLLBBBBBBBBZZZAAATTTTTTTTTTTTTTTTJJFFFFFFFFFFEEEEEEEEEEEEOCCCCCCCC
VVTTWWWWWWWWWWWWWWYYYYURRWYJWWWWKKKKKMKJJJJJJJJJXXXXXXXXUYYYYYYAAAAAAAALLLLLLBBBBBBZZZZZAAATTTTTTTTTTTTTTTTJJJFFFFFFFFFEEEQEEEEEEEEOCPCCCCCC
VVTWWWWWWWWWWWWWWWYYYYYPWWWWWWWWKKKKKMMJJJJJJJJJEEXJJNVXVVSVVVVVVAAAAAALLLLLLLLLSVSZZZZAAAATTTTTTTTTTTTTTTTJJJFFFFFFFFFFEEEEEEEEOOOOCCCCCCCC
VVVWWWWWWWWWWWYYYYYYYYYYYWWWWWWWWKKKKMMMJJJJJJJEEENNNNNNVVVVVCVVVVAFAAFLLLLLLLLXSSSZZIZAAAATTTTTTTTTTTTTTTJJJJFFFFFFFFFEEEEBEEEEEZZZZCCCCCCC
VVVWWWWWWWIWWWCYYYYYYYYYYWWWWWWWWWKKKMMMMMJJJJJJENNNNNNNVVVVVVVVVVFFFFFFLLLLXXXXDSSZIIAAAAATTTTTTTTTTTTTJJJJJJJKFFFFFFEEEEZBZEDZZZZZZCCCCCCJ
VVWWWWWWWWWWWWYRRYYYYYYYYWWWWWWWWWWKPPPPPMMMMMJJJNNNNNNVVVVOVVVVVVFFFFFFFLLXXXVXSSSIIIAAAAATTTTTTTTTTTTTJJJJJJJFFFFSTTEEEEZZZZZZZZZZZCCCCCJJ
DDDWWWWWWWWWWYYYYYYYYYYYWWWWWWWWWWWPPPPPPPMMMMJJJZNNNNNVVVVVVVVVVFFFFFFFFFXXXXXXSSSIIIAAAAATTTTTTTTTTTTTJJJJJJFFFYFFTTTTTEZZZZZZZZZZZZZCCCJJ
DDBWWWWWWWWWWYYYYYYYYYYYWWWWWWWWWWWPPPPPPPPMMMMMJZZNNNNVVVVVVVVVVFNFFFFFFFXXXXXXSSIIIIAIAAATTTTTTTTTTTTTJJJJJJJJFYYTTTTTTEZZZZZZZZZZZZZYCCCC
DDDDWWWWWWWWWYYYYYYYYYYYYWWWWWWWWWPPPPPPPPPPMMIIIZZNNNNNNNVVVVVVVVNFFFFFFFXXXXXXSSIIIIIIIAATTTTTTJJJJJJJJJJJUUUYYYJTTTTTTZZZZZZZZZZZZZZYYCCR
DDDWWWWWWWWWWYYYYYYYYYYYYWWWWWWWWPPPPPPPPPPPIIUIIIZIINNNNVVVVVVFFNNFFFFFFFFXXXXXSSSTTIIXSAATTTTTTJJJJJJJJJJJUUUPJJJJTTTCCZZZZZZZZZZZZZZYYWCR
DDDDWWWWVWWWWYIGYYYYYYYYYWWWWWWWLLPPPPPPPPPPIIIWWWWWIINNNNNNVVVFSFNFNFFFFFFXXXXXXXXXXXHXSAAAHZZZZZHHZZJJJJJVUUUPJJJJTTTTTFFFFZZZZZZZZZWWYWWR
VDWWWWWVVVWGWYGGYYYYYYYYYWWWWWWWPPPPPPPPPPPIIIIWWWWWINNNNNNNNNNFFFNNNFFFFFXXXXXXXXXXXHHXSAXHHHZZHHHHZZJJJJJVUUUPJJJTTTTTTTFFFFFZZZZWWZWWWWWW
VWWVWWVVVVWGGGGGYYYYYVPYYYWWWLWLLPPPPPPPYPDIIIIWWWWWINNRNNNNNNFFFFFNNFFKFXXXXXXXXXXXXHXXXXXXHHHHHHHZZZJJJJGVVUPPJPGTTTTTCTFFFFFZWWWWWWWWWWEE
VVVVWUVVVVVGGGGGGGGZZPPPPYWWWLLLPPPPPPPPPIIIIIIWWWWWRRRRNNNNNNFFFFFFFFFFFXXXXXXXXXXXXHHXXXXXHHHHHHHHHHJJJJGGPPPPPPPBGGTTTTFFOFFZWWWWWWWWWWEE
VVVVWVVVVVVFGGGGGGPPPPPPPPPPWLLLPPPPPPPPPPIIIIIWWWWWNNNNNNNNNFJFFFFFFFFFFFXQXXXXXXXXXHHXXXXXHHHHHHHHHHGGGGGGPGGPGBBBGGGGJOOFOFOOWWWWWWWWWWWW
VVVVWVVVVVVVVVGGGXXXPPPPPPPPILLPPPPPPPLPYYIIIIIWWWWWNNNNNNNNNFFFFFFFFFFFFFQQHHXHHXXXDFHHHHHHHHHHHHHHHHGGGGGGGGGGGGBGGGGGOOOOOOOHWWWWWWWWWWWW
VVVVVVVVVVVVVVVVVXXXXXXPPPPPILLPPPPPPPPYYXIIIIIWWWWWWWWWWWNNNNFFFFFFFFFFFFFQHHHHHXHFFFFFFHHHHHHHHHHHHHHGGGGGGGGGEEGGGGGGOOOOOOOWWWWWWWWWWWWW
VVVVVVVVVVVVVVVVXXXXXXXXPPPPILIIIPIPLLPYXXIPIIIWWWWWWWWWWWNNNFFFFFFFFFFFFFYQHHHHHHHFFPFFFHHHHHHHHHHHHHHGGGGGGGGGGEEEGGGGGOOGOOWWWWWWWWWWWWWT
VVVVVVVVVVVVVVVVVVXXXXXPPPPPIIIIIIIIIIIIPXXXIIIWWWWWWWWWWWNNNFLFPPFFFFFFFFYQHHHHHHHFFFFFFHHHHHHHHHHHHHHGGGGGGGGEEEEGGGGGGGGGGGGWWWWWWWWWWWTT
VVVVVVVVVVVVVVVVVVXXXXXXXPIIIIIIIIIIIIIIPXXXXXIIWWWWWWWWWWNNNNNNPPPFFFFFFFYHHHHHHFFFFFFFFFFFHFFFHHHHHHHGGGGGGGGGEEEGGGGGGGGGGBBYWWWTWWWWWTTT
VVVVVVVVVVVVVVVVVXXXXXXXXPPIIIIIIIIIIIIKXXXXXXXIWWWWWWWWWWNNNNPPPPPFFFFFHHYYHHHHFFFFFFFFFFFFFFFZHHHHHHHHGGGGGGGGEPGDDGGGBBBGBBBYYYBTWWWWTTTT
VVVVVVVVVVVVVVVVVVXXSSSSSYSSIIIIIIIIIXKKXXXXXXXIWWWWWWWWWWNNPPPPPPFFFFFHHHYYHHHHFFFFFFFFFFFFFFPZZHZHHHHHHHGGGKKGPPGGGGGGBBBGBBBBBBBTWWWTTTTT
VVVVVVVVVVVVVVVVVXXXSSSSSSSSFFFIIIIIIXXKXXXXXXXXWWWWWWWWWWNNNPPPPPPPFFHHHHHHHHHHFFFFFFFFAFFFFPZZZZZHHHHHHHGGKKSSPPPOOGGGBBBBBBBHBBBBBDBBTTTT
VVVVVWVVVVVVVVVVUSXSSSSSSMMMMFIIIIIIIXXXXXXXXXXXXXWWWWWNNNNNNNNPPPFFFFFFHHHHHHHHFFFFFFFAAAFFFZZZZZZZHHHHHHGGKKKPPOOOOGGBBBBBBBBHHBBBBBBTTTTT
VVVVVWWVVVVVVVVVUSSSSSSSSSMMMFFIIIIIIXXXXXXXXXXXXXWWWWWEMNNNNNNPPPPPFHFHHHHHHHHFFFFFFFFFFFFFFDZZZZZLHHHHHHHSKKKPPPPOOOGGLBBBBBZBBBBBBBTTTTTT
VWWVWWWWWVVVVVUUUUSSSSSSSSSMMFFIIIIIXXIXXXXXXQQQQXWWWWWEMIMNMWMPMMPPPHHHHHHHHHHHHFFFFFFFFFCCCZZZZZZLHIIHHHHSSKPPPPPOOOGOBBBBBBBBBBBBBBTTTTTT
VWWWWWWWWWWWVUUUUUSSSSSSSMMMPFFFIPIIIIIIXXXQQQQQQQWWWWWMMIMMMMMMMMMPPPHHHHHHHHHHQSFFFFFFFCCCCZZZZZZLHHHHHHHSSSSPPPOOOOOOBBBBBBBBBBBBBTTTTTTT
WWWWWWWWWWWWWUUUUUSSSSSSSSMMPFPPIPPIIIIIXXXQQQQQQQQQQQMMMMMMMMMMMMMMPPHHHHHHJJJJSSSSFFCCCCCZZZZZZLLLSSSHHHHSSSSSSOOOOOOOOOBOOSSBBBBBBTTTTTTT
WWWWWWWWWWWWWUUUUGCSSSSSSSMPPPPPPPPPIIIIQQXQQQQQQQQQQQQMMMMMMMMMMMMMPMMDHHHHJSSSSSSSSCCCLLLZZZZZZLLLLSSSSSSSSSSSSSOOOOOOOOOOSSSSSBBBBBTTTTTT
WWWWWWWWWWWWUUUUUGCSSSSSMMMPPPPPPPPPPIIIJQQQQQQQQQQQQQQQQMMMMMMMMMMMMMDDDHHDSSSSSSSSSCCLLLLZZZZZZLLLLSSSSSSSSSSSSSSOOOOOOOOOSSSSSSSBTBBTTTTT
WWUWWWWWWWWWUUUUUGSSMSSMMGMPPPPPPGEEEEEEJJQNQQQQQQTQQQQQQMMMMMMMMMMMMMMDDHHDSSSSSSSSSSSLLLLZZZZZZLLLLLSSSXSSSSSSSOOOOOOOOOOOSSSSSSSTTTTTTTTT
WWWWWWWWWWWWUUUUUGSSMMMMMGMPPPPPPPPEEEEEEJQQQQQQTQTTTTQYAAAAAAAMMMMMMMMDDDDDSSSSSSSSSSSSLLLLLZZLZLLLLLSSSSSSSSSSSOOOOOOOOOOSSSSSSSSTTTTTITII
WSSSSSWWWWWWWUGGGGSSSMMMMGGPPPPPPPEEEEEEEEQQQRRTTQTTTLJYAAAAAAAAAAMMMMMDDDDDDDSSSSSSSSSSLLLLLLLLLLLLLLSSLSSSSSSSOOOOOOOOOOOOOOSSSTTTTTTIIIII
TTSSSSSSWWWWTGGGGGGGGGMMMGGDDDPPPPEEEEEEEEQQQTTTTTTTTLJJAAAAAAAAAAMMMDMMDDDDDDSSSSSSSSSLLLLLLLLLLLLLLLLLLLSSSSSOOOOOOOOOOOOOSSSSSSSTTTIIIIII
SSSSSSSSSWWTTGGGGGGGGGGGMGGGGGPPPPEEEEEEEEERRTTTTTTTTJJJAAAAAAAAAAMDDDDDDDDDDDSSSSSSSSSSLSSLLLLLLJJZJLLLLLLCSCCCCCOOOEEEOOOSSSSSSSSSIIIIIIII
SSSSSSSSSSWWTGGGGGGGGGGGGGGGGGEEEEEEEEEEEERRRRTTTTTTTJJJAAAAAAAAAAMPPDDDDDDDDSSSSSSSSSSSSSJJJJJLLJJJJJBBBCCCCCCCCCCOOEEEEEEESSSSSSSSSSIIIIII
YSSSSSSSSSLWTTJGGGGGGGGGGGGGGGEEESEEEEEMERRTTTTTTTTTTJJJAAAAAAAAAAPPPDDDDDDDDSSSSSSSSSSSSAAJJJJJJJJJJBBBBCCCCCCCCCCEEEEEEKESSSPVVSSSIIIIIIII
YSSSSSSSSSJJTTJJJGGGGGGGGGGGGSSSSSEKMMMMMRRRTTTTTTTJJJJJAAAAAAAAAAPPPDDDDDDDSSSSSSSSSSSSSSAAJJJJJJJJJBBBBBCCCCCCCCCEEEEEEERRSSVVVVVVDDIIIIII
YSSSSYYSSWJJJJJJJJJGGGGGGGGXGSSSSUUKKMMMRRRRTTTTTTTJJAAAAAAAAAAAAARRPPDDDDPPXSSSSSSSSSSSSSAAAJJJJJJJJBBBBBBBCCCCDDEEEEEEEEERSVVVVVVVVVIIIIII
YYSSSYYYYJJJJJJJJJGGGGGGGGGGSSSSUUUKMMMMMMRRRTTTTTTJJAAAAAAAAAAAAAPPPPPPDDPPXXSSSSSAAAAAAAAAJJJJJJJJJJJJJJBBCCCCDZZZEEEEEEEENVVVVVVVVVIIIIII
YYSYYYYJJJJJJJJJJGGGGGGGGGGSSSUSUUMMMMMMMMRTTTTTTJTJJAAAAAAAAAAAAAPPPPPPPPPPPXSXSSSAAAAAAAAAJJJJJJJJJJJJJJBBBBBBZZZZEEEEEEEEVVVVVVVVVVIIFIII
YYYYYYYJJJJJJJJJJJJJGGGGGGGSSSUSUUMMMMMMMMMMBBTTJJJJJAAAAAAAYYRRPPPPPPPPPPPPPXXXSXXKAAAAAAAAJJKJJJJJJJJJJJBBBZZZZZZZEEEEEERRRVVVVVVVVVVVFFFF
YYYYYJJJJJJJJJJJFFJJJGGGGGGUUUUUUMMMMMMMMMMMMBTTTJJJJAAAAAAAYYRPPPPPPPPPPPPPPXXXXXXKKKKKAAAJJJJJJJJJJJJJBBBBBZZZZZZZEEEEEEVVVVVVVVVVVVVVVFFZ
YYYYYJJJJJJJJJJJJJJJIIIGGGUUUUUUUMMMMMMMMMMMBBTTJJJJJAAAAAAAYYRPPPPPPPPPPPOOXXXXXXXKKKKKKAAZIIJJJJJJJJJJBBBBBBBZZZEEEEEEEEEVVVVVVVVVVVVVVVZZ
YYYYJJJJJJJJJJJJJJJJIITTGGUUUUUUUUMMMMMMMMMMMMJJJJJJJAAAAAAARRRPPPPPPPPPPPOOOXXXXXXKKKKKKKAZIIZJJJJJJJJJBBBBBBBBZZZEEEEEEVEVVVVVVVVVVVVVVFOZ
YYYYYJJJJJJJJJJJJJJJIIIIIIUUUUUUUUCCCMMMMMMMMMMMMJJJJJJYYYYYYRYYPPPPPPPOOOOOOXXXKKKKKKKKKKZZZZZJJJJJJJJJBBBBBBBBBSZUEEEEEVVVVVVVVVVVQOOVOOOZ
YYYYYJJJJJJJJJJJJJZZIIIIIIUUUUUUUUUUUMMMMMMMMMMMMJJJJJJJYYYYYYYYPPPPPPPOOOOOOOOOKKKKKKKKKZZZZZZJZZJJJJJJBBBBBBBBBBBUUUEEEEVVVVVVVVVVVOOOOOOZ
YYYYYJJJJJJJJJJJJMBIIIIIIIIUUUUUUUUUUMMMMMMMMMMJJJJJJJJJJYYYYYYYYYYPPPPOOOOOOOOOKKKKKKKKKZZZZZZZZZJJJJHJBBBBBBBBBBBUUUEUUUUVVVVVVVVVVOOOXXOZ
YYYYYJJJJJXXJJJJBBBDIIIIIIEUUUUUUUUUUMMMMMZKFFMMJJJJJJJJJYDYYJYYYYYYYPPOOOOOOOOOOOKKKKKKKZZZZZZZZZZJJJHHHHBBBBBBBBBUUUUUUVVVUVVVZVBBOOOOXXOO
YYYYYJYYJJHXHJJJBBBDIIIIEEEEEUUUUUUUUMFMMMKKKKCCCJJJJJJJJJDDYYYYYYYYPPPOOOOOOOOOOOKKKKKKKZZZZSZZZZZJJJHHHHNBBBBBBUUUUUUUUUUUUVJVVVOOOOOOOXOO
YYYYYYYYHHHHHHHBBBBIIIIIEEEEEUUUUUUNNMFMFFKLKKCCJJJJJJJJJJDDYYYYYYYYPPPOOOOOOOOOOKKKKKKKKKZZZZZZZZZJJIKHHHNNBBBBBUUUUUUUUUUUCSCMVEEOOOOOOOOO
YYYYYYYYYRXHXHBBBBBIIIIEEEEUUUUUUUUUUFFFFFFKKKKCJJJJJJJJJMYYYYYYYYYYYOOOYYOOOOOOOOKKKKKKKKZZZZZZZZZZKKKHHNNNNNBBBUUUUUURRUCCCCCCEEEOOOOOOOOO
YYYYYYYYYRHHHBBBBBBBBBBBBBBKUUUUUUUUUUUFFFFKKKKKKJUCCCCCCYYYYYYYYYYYYYYOOOOOOOOOOOOKKKKKKKKKZZZZZZZZKHHHNNNNNNBBBUUUURRRQCCCCCCCEEOOOOOOOOOO
YYYYYYYYYRBBBBBBBBBBBBBBBBBKUUUUUUUUUUUUKFKKKKKKKUUCECCCCDYYYYYYYYYYYYYAOOOOOOOSOOKKKQQQKKKKKZZZZZKKKHHHHHNNNNNNNNRRRRRRQCCCCCCCEELOOOOOOOOO
YYYYYYYYRRRBBBBBBBBBBBBBBBSUUUUUUUUUUUUAKKKKKKKCKCCCCCCCCDDYYYYYYYYYYYYAAOOOOOOOHHKKKQQQKKKKZZZRZZKKKHHKKHNNNUNNNRRRRRRRCCCCCCCTLLLOOOOOOOOO
YYYYKUUUUUBBBBBBBBBBBBBBBBSSUUTUUUUUUUAAKAKKKKKCCCCCCCCCCCCWYYYYYYYYYYYYYHOOBOOHHHQQQQQQQQQQBBBBZZZKKKKKKHKKKKNNNRRRRRRRCCCCCCCCLLVOOOOOOOOO
YYYYKKUUUUUBBUUUBBBBBBBBBBSSSUUSUUUUUUAAAAKKKKKKKCCCCCCCCCCCCCCYYYYYYHHHHHHOOOHHHHQAQQQQQQQQBBBZZKKKKKKKKKKKKYYNNRRRRRRCCCCCCCCCLLLLOOOOOOOO
YYKKKKUUUUUUUUUBBBBBBBBBBBSSSUSSUUUSAAAAAKKKKKKKKCCCCCCCCCCCCCCYYYYYYYHHHHHOHHHHHQQQQQQQQQQQBBBBBKKKKKKKLKKKKYYYRRRRRRCCCCCCCCCCLCJJZZZODOOS
YYKKKKKUUUUUUUUBBBBBBBBBBBBBSSSSSUUSAQAAAKKKKKKKKKCCCCCCCCCCZZZYYYYYYHHHHHHHHHHHHHQQQQQQQQQQBBBIBKKKKKKKKKKKKKRRRRRRRRCCCCCCCCCCCCJZZZZOOOOS
YKKKKKKKKKUUUUGBBBBBBBBPPBBBSSSSSUSSSQQKKKKKKKKKKKCCCCCCCCCCCCHHHYHYHHHHHHBBBBHHHHQQQQQQQQBBBBBBBKBKKKKKKKKKKKKRRRRRRRCCCCCCCCCCTCCZZZZZZZOS
KKKKKKKKKUUUUUUBBBBPPPPPPPSSSSSSSSSSSQKKKKKKKKKKKKCTCCCCCCCCYCHHHHHHHHBHHBBBBHHHHQQQQQQQQQQBBBBBBKBKKKKKKKKKKKRRRRRRRRRRCCCCCCCCTTZZZZZZZZSS
KKKKKKKKKKUUUUUBBBBPPPPPPPSSSSSSSSSSSQKKKKKKKKKKKKCCCCCCCCCYYYYYHHHHHHBBBBBBBGGGHQQQAQQQQQQQQBBBBBBKKKKKKEEEKKRRRRRRRRRRZCCCCCCCTTZZZZZZZZZZ
KKKKKKKUUUUUUUUUBBBPPPPPPPSSSSSSSSSSSQKOKKKKKKKKKKCCCCCCCCYYYYYYHHHHHHBBBBBBBGGGHHGGGQQQQQEEEEBBBBBBKKEKKEEEEERRRRRRRRRRCCTTCCCCTTTZZZZZZZZZ
EKKKKKKKKKUJUUUUBBBBPPPPPPSSSSSSSSSSSSSSKKKKKKKKKKCCCCCCCCYYYYYYHHHHHHBBBBBBUGGGHGGGGGQQQQEEEEEEEBBBBKEKEEEEEERRRRRLRRRRRRTTKKKKTZZZZZZZZZZU
KKKKKKKKKKUJUUAABJBBPPPHPPSSSSSSSSSSSSSKKKCKKKKKKKCCCRRRCCCYYYYYYHHHHBBBBBBBUGGGGGGGQQQQQQQEEEEEEBBBBEEEEEEEEEEERELLLLRRRRTTKKKKTTTTZZZZZZUU
GKKKKKKKKUUUUUUGGJJPPPPHHPSSSSSSSSSSSSSSSSCCCKKKKKCKRRRRRRYYYYYYHHHHHHBBBBBBBGGGGGGQQQQQQQEEEEEHHBBBEECCCEEEEEEEEELLLLRRLLTKKKKKTTTTZZZZZZUU
GKKKKKKKKUUGUGGGGJHHPPPHHPSHHSSSSSSSSSSSCCCCCKKKKKKKRRYYYYYYYYYYYHHHHBBBBBBBJGGGGGGGQQQQQEEEEEEHHBBBCCCCCCEEEEEEEELLLLRRQLTTKKKKTTTTZUZZZUUU
GGKKKKKKKAGGGGGGJJJJJJJJJJHHHHSSSSSSSSSSCCCCKKKKVKKRRRRRYYYYYYYYHHHHHHBBBBBBJGGGGGGGQQQHQQQQEEHHHCCCXCCCEEEEEEEEEELLLLLLLLTTTKKKTTTTZZZZZZZU
GGGKKKKKKGGXGGGGJJJJJJJJJJHHHVVVSSSSSSSSCCCCCCCVVVRRRRRRYOYVYCCHHHHHHHBBBBJJJGGGGGGGQHQHHHEEEHHHHCCCCCCCCEEEEEEELLLLLLLLLLTTTTTTTTTTTTTTZZZU
GGKKKKKKGGGGGGGGJJJJJJJJJJHHHVSSSSCSSSCCCCCCCCCVVVVRRVVVVVVVVHHHHHHHHHHBIBGGGGGGGGGGHHHHHHHEHHHHHCCCCCCCCCCCEEELLLLLLLLLLLLTTTTTTTTTTTTTTTZD
GGKKKKKKGGGGGGGGJJJJJJJJJJHHHVWQSCCCCCCCCCCCDCVVVVVVVVVVVVVVMHHHHHHHHHQBBBGQGGTGGGGGDHHHHHHHHHHHHCCCCCCCCCCEEEELLLLLLLLLLLLTTTTTTTTTTTTTTTTD
GGGKGGGGGGGGGGGGJJJJJJJJJJHSHWWWWCCCCCCCCCFFFFFVVVVVVVVVVVVVMHHMHMMMMMQQQQQQQQGGGGHHHHHHHHHHHHHHPPCCCCCCCCMQQEELLLLLLLLLLLTTTTTTTTTTTTTTTTTD
GGGGGGGGGGGGGGGGJJJJJJJJJJSSWWSWWCCCCCCCCDFFFFFVJVVVVVVVVVVVMHHMMMMMMQQQQQQQQQGGQQHHHHHHHHHHHHHHCCCCCCCCCCCQQQLLLLLLLLLLLLLTLKKKKTTTDDTDDDDD
UUUUGUGGGGGGGGGGJJJJJJJJJJSSSSSSCCCCGCGFFFFFFFFDVVVVVVVVVVVMMMMMMMMQQQQQQQQQQQQQQQHHHHHHHHHHHHCCCCCCCCCCCCCQQLLLLLLLLLLLLLLTLKKKKTTTDDDDDDDD
UUUUUUUGGGGGGGGGGGLLBBHMSSSSSSSSSGGGGGGFFFFFFFFDDDVVVVVVVVVMMMMMQQQQQQQQQQQQQQQQHHHHHHHHHHHHHHHCCCCCCCCCCCCQQLLLLLLLLLLLLLLLLKKKKTTTDDDDDDDD
UUUUUUUUGGGGGGGGGGLBBHHSSSSSSSSSGGGGGGGFFFFFFFFDDDVVVVVVVVMMMMMMMMQQQQQQQQQQQQQQHHHHHHHHHHHHHHHCCCCCCCCCCQQQLLLLLPLLLLLLLLLLLLKKKKTTTDDDDDDD
UUUUUUUUGGGGGSSSGLLLBSSSSSSSSSSSSGGGGGGFFFFFFFDDDDDVVVVVVVMMMMMMQQQQQQQQQQQQQQQPTTHHHHHHHHHHHHHCCCCCCCCCQQQQQQLBBPLLLAALLLLKKKKKKKKTTDDDDDDD
UUUUUUUUUUUGSSSSSBBBBBSSSSSSSSSSSRGGGGGFFFFFDDDDDDDVVVVVVVVMMMMMMMMQQQQQQQQQQQQPTTTHHHHHHHHHHHHCCCCCCCCQQQQQQQBBBBWLAAAALLLKKKKKKKTTDDDDDDDD
UUUUUUUUDUSGSSSSSSBBBBBSSSSSSSSSRRGGGGGFFFFFCDDDDDDVVVVVVCCMMMMMMMMMMQQQPPQPQPQPPTTHHHHHHHHHHHCCCCCCPCCQQQQQBBBBBBBAATTAATLKKKKKKKDDDDDDDDDD
UUUUUUUUUUSSSSSSSSBBBBSSSSSSSSSSRRGGGGGGFFFFCCDDDDDTTTVVVCCCCMMMMMMMMMQPPPPPPPPPPTHHHHHKKHHHHHHCCCCCQCQQQQQQBBBBBBBBATTTTTTTTKKKKNNNNDDDDDDD
UUUUUUUUUUSSSSSSSSBSSSSSSSSSSSSSSGGGGGGGGGCCCCCDDDDDDTVVVCCCCCMMMMMMMAATPPPPPPPPPTHHHHHKKHHHHHHCCCCQQQQQQQQBBBBBBBBBTTTTTTTTTKKKKKKNNNDDDDDD
UUUUUUUUSUSSSSSSSSSSSSSSSSSSSSSWGGGGGGGGGGCCCCCDDDDDDDDVVCCCCCMMMMMMMAAATPPPPPPPTTHKKKKKKHHHHHCCCQQQQQQQQQBBBBBBBBBTTOTTTTTTLKKKKKKNNNDDDDDD
UUUUUUSSSSSSSSSSSSSSSSSSSSSSSSSWPGGGGGGGGGCCCCCGDDIIIDHVVVCCCCCMMMMMAAAAPPPPPPPEEEKKKEKEEHHHHHHCQQQQQQQQQQQBBBBBBBZTTTTTTTTTKKKKEKKGGGGGGGDG
UUUUUUUUSSSSSSSSSSSSSSSUUSSSSWSWWGGGGCGGGGCCCCCCCIIIICCCCCCCCCCCJJMAAAAPPPPPPEEEEEEEEEEEEEEHHHHHHQQQQQQQQQQBBBBBBBZZTTTTTTTTTKKKKKKGGGGGGGGG
UUUUBUSUSSAAAASSSSSSSSSUUUSSSWWWWGGGGCGGCCCCCCCCCIIIIICCCCCCCCCCCCAAAAAAPPAAEEEEEEEEEEEEEEEHHHHHQQQCQQQQQQQBBBBBBBZZTTTTTTTTTTBKGGKGGHHGGGGG
DDUUUSSSSAAAAAAASSSSSSSSUUUWWEWVWGFGCCCCCCCCCCCCIIXXXICCCCCCCCCCAAAAAAAAPPPAPPPEEEEEEEEEEUUUUUHHMQQQQQQQQQQQBHBBBBBTTTTTTTTTTTTGGGGGHHHGHGGG
DUUUUSSSSSBBAAAASSSSSSSUUUWWWWWVWFFFFFCCCCCCCCCCXXXXXCCNCCCCCCCCAAAAAAAAPAAAPPEEEEEEEEEEEUEEEUUZZQQQQQQQQQNZHHHBBBBTTTTTTTTTTTTGGGGGHHHHHGGG
DDDDUDDSSSSAAAAAASSSSUUUUUWWWWWWWWFFFCCCCCCCCCCCXXXAXACCCCCCCCCCCAAAAAAAAAAAAPEEEEEEEEEEEEEEEUZZZZQQQQQQQQZZZHHHBBBSTTTTTTTTTTGGGGGHHHHHGGGG
DDDDDDDSSSZAAAAAASSSUUUUUUWWWWWWWWFFFFFFCCCCCCCCCXXAAACECCCCCCCCCCAAAAAAAAAAAAAEEEEEEEEEEEWZUUUZZZZQZQZQQQZHHHHHHHBTTTTTTTTTTTGGGGGHHGHGGGGG
DDDBDDDDSDAAAAAAAUUUUUUUUUWWWWWWWWFFFFCCCCCCCCCCCCAACCCCCCCCJCCCAAAAAAAAAAAAAAEEEEEEEEEEEEEZZUUZZZZZZZZQZZZHZHHHHHHHHTTTTTTTTGGGGGGHHGGGGGGG
DDDBBDDDSDDDDAAVVVUUUUUUUUUWWWFWWFFFFFCCCCCCCCCCCCCCCCCCCCCJATAAAAAAAAAAAAAAAAAAEEEEEEEEEEEZZZZZZZZZZZZZZZZZZHHHHHHHHTTTTTTTGGGGGGGHHGGGGGGG
DDDBBBDDDDDDDDAAAAAUUUUUUUUWFFFFFFFFFCCCCCCCCCCCCCCCCCJCCCCJAAAAAAAAAAAAAAAAAAAAEEEYYEEYYEEESSZZZZZZZZZZZZZZHHHHHHHHTTTTTTTGGGGGGGGGGGGGGGGG
DDDBBDDDDDDDDDDDAQQQUUUUUUUFFFFFFFFFFFFCCCCCCCCCCCCKCCJJJJJJAAAAAAAAAAAAAAAAAAAEEEYYYYYYYYESSSSSZZZZZZZZZZZZHHHHHHHHHTTTTTTGGGGGGGGGGGGGGGGG"""

matrix_move = [(-1, 0), (0, 1), (1, 0), (0, -1), ]

def read_input(imap):
    return [list(row) for row in imap.split("\n")]

def printimap(imap):

    print("  ", end='')
    for i in range(len(imap)):
        print(f"Y{i} ", end="")

    print('')
    for index, i in enumerate(imap):
        print(f"X{index}", end='')
        for k, j in enumerate(i):
            print(f" {j} ", end='')
        print('')

def find_perimeter(imap, plant, x, y, vis):
    adjacents = 0
    area = 0
    queue = [(x, y)]
    vis[x][y] = 1
    while queue:
        x, y = queue.pop(0)
        for i, j in matrix_move:
            if x+i < 0 or x+i >= len(imap) or y+j < 0 or y+j >= len(imap):
                continue
            if imap[x+i][y+j] == plant:
                if vis[x+i][y+j] == 0:
                    vis[x+i][y+j] = 1
                    queue.append((x+i, y+j))
                adjacents += 1
        area += 1

    return area, adjacents

def main(imap):
    # Find sub maps
    cost = 0
    vis = [[0 for _ in range(len(imap[0]))] for _ in range(len(imap))]
    for index, i in enumerate(imap):
        for jindex, j in enumerate(i):
            if j != '.' and vis[index][jindex] == 0:
                area, adjacents = find_perimeter(imap, j, index, jindex, vis)
                fences = (area * 4) - adjacents
                # print(j, area, adjacents, fences)
                cost += area * fences

    return cost

print(main(read_input(imap2)))

